import math
import random
import string

def mask_digits_only(s):
    return ''.join(random.choice(string.digits) if ch.isdigit() else ch for ch in s)

def mask_numeric_value(val):
    if pd.isnull(val):
        return val

    # Handle numeric types directly
    if isinstance(val, (int, float)):
        if isinstance(val, float) and not val.is_integer():
            # It's a real float, keep decimal part
            val_str = str(val)
        else:
            # It's an int or a float like 123.0 — treat as int
            val_str = str(int(val))
    else:
        val_str = str(val).strip()

        # If it's not all digits (e.g., "abc", "123a") — don't mask
        if not val_str.replace('.', '', 1).replace('-', '', 1).isdigit():
            return val

    return mask_digits_only(val_str)