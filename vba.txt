 Function ReplaceAsteriskText(inputText As String) As String
    Dim regex As Object
    Set regex = CreateObject("VBScript.RegExp")
    
    regex.Pattern = "\*[^*]*\*"
    regex.Global = True
    
    ReplaceAsteriskText = regex.Replace(inputText, "XXX")
End Function

Function ReplaceAllAsteriskSections(inputText As String) As String
    Dim regex As Object
    Set regex = CreateObject("VBScript.RegExp")
    
    With regex
        .Global = True
        .Pattern = "\*[^*]*\*"
    End With
    
    ReplaceAllAsteriskSections = regex.Replace(inputText, "XXX")
End Function

Function MaskAsteriskWords(text As String) As String
    Dim result As String
    Dim i As Integer
    Dim inAsterisk As Boolean
    Dim ch As String

    inAsterisk = False
    result = ""

    For i = 1 To Len(text)
        ch = Mid(text, i, 1)
        If ch = "*" Then
            inAsterisk = Not inAsterisk
            result = result & "*"
        ElseIf inAsterisk Then
            result = result & "X"
        Else
            result = result & ch
        End If
    Next i

    MaskAsteriskWords = result
End Function

Function MaskAsteriskWords(text As String) As String
    Dim result As String
    Dim startPos As Long
    Dim endPos As Long
    Dim tempText As String

    result = text
    startPos = InStr(1, result, "*")

    Do While startPos > 0
        endPos = InStr(startPos + 1, result, "*")
        If endPos = 0 Then Exit Do

        tempText = Mid(result, startPos + 1, endPos - startPos - 1)
        If Len(tempText) > 0 Then
            result = Left(result, startPos) & String(Len(tempText), "X") & Mid(result, endPos)
        End If

        startPos = InStr(endPos + 1, result, "*")
    Loop

    MaskAsteriskWords = result
End Function

Function MaskAsteriskWords(text As String) As String
    Dim result As String
    Dim pos As Long
    Dim inAsterisk As Boolean
    Dim ch As String

    result = ""
    inAsterisk = False

    For pos = 1 To Len(text)
        ch = Mid(text, pos, 1)
        If ch = "*" Then
            inAsterisk = Not inAsterisk
            result = result & "*"
        ElseIf inAsterisk Then
            result = result & "X"
        Else
            result = result & ch
        End If
    Next pos

    MaskAsteriskWords = result
End Function


Function MaskInsideAsterisks(ByVal text As String) As String
    Dim i As Long
    Dim inAsterisk As Boolean
    Dim result As String
    Dim ch As String

    result = ""
    inAsterisk = False

    For i = 1 To Len(text)
        ch = Mid(text, i, 1)
        If ch = "*" Then
            inAsterisk = Not inAsterisk
            result = result & "*"
        ElseIf inAsterisk Then
            result = result & "X"
        Else
            result = result & ch
        End If
    Next i

    MaskInsideAsterisks = result
End Function
