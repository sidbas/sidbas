Function ReplaceAsteriskText(inputText As String) As String
    Dim regex As Object
    Set regex = CreateObject("VBScript.RegExp")
    
    regex.Pattern = "\*[^*]*\*"
    regex.Global = True
    
    ReplaceAsteriskText = regex.Replace(inputText, "XXX")
End Function

Function ReplaceAllAsteriskSections(inputText As String) As String
    Dim regex As Object
    Set regex = CreateObject("VBScript.RegExp")
    
    With regex
        .Global = True
        .Pattern = "\*[^*]*\*"
    End With
    
    ReplaceAllAsteriskSections = regex.Replace(inputText, "XXX")
End Function

Function MaskAsteriskWords(text As String) As String
    Dim result As String
    Dim i As Integer
    Dim inAsterisk As Boolean
    Dim ch As String

    inAsterisk = False
    result = ""

    For i = 1 To Len(text)
        ch = Mid(text, i, 1)
        If ch = "*" Then
            inAsterisk = Not inAsterisk
            result = result & "*"
        ElseIf inAsterisk Then
            result = result & "X"
        Else
            result = result & ch
        End If
    Next i

    MaskAsteriskWords = result
End Function
