[
  {
    "$group": {
      "_id": {
        "msg_id": "$msg_id",
        "stmt_id": "$stmt_id",
        "dbcr": "$entry.db_cr_ind"
      },
      "count": { "$sum": 1 },
      "sum": { "$sum": "$entry.amount" }
    }
  },
  {
    "$group": {
      "_id": {
        "msg_id": "$_id.msg_id",
        "stmt_id": "$_id.stmt_id"
      },
      "calc": {
        "$push": {
          "k": "$_id.dbcr",
          "v": {
            "count": "$count",
            "sum": "$sum"
          }
        }
      }
    }
  },
  {
    "$project": {
      "_id": 0,
      "msg_id": "$_id.msg_id",
      "stmt_id": "$_id.stmt_id",
      "calc": { "$arrayToObject": "$calc" }
    }
  }
]